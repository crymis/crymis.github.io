<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="utf-8">
    <title>100 Days of Push-ups</title>

    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="mobile-web-app-capable" content="yes">
    <!-- Place favicon.ico and apple-touch-icon.png in the root directory -->
    <link rel="shortcut icon" type="image/png" href="favicon.png">
    <link rel="icon" type="image/png" href="favicon.png">
    <link rel="stylesheet" href="style.css">
</head>

<body id="bg">
    <button id="mute-button" aria-label="Toggle mute">ðŸ”Š</button>
    <main>
        <h3 id="today"></h3>
        <div class="parallax-wrapper">
            <div class="parallax-container" data-jkit="[parallax:strength=0.3;axis=both]">
                <h1 id="pushups" class="parallax"></h1>
            </div>
            <div class="parallax-container" data-jkit="[parallax:strength=0.3;axis=both]">
                <h2 id="subtitle" class="parallax"></h2>
            </div>
        </div>
        <div id="checkbox-container">
            <input type="checkbox" id="pushup-check">
            <label for="pushup-check">HAVE YOU DONE YOUR PUSH-UPS TODAY?</label>
        </div>
        <p id="quote"></p>
        <p id="quote-info"></p>
        <h1 id="madeIt"></h1>

        <div class="trophyBg">
            <div class="trophy"></div>
        </div>
    </main>

    <footer>
        <p>CREATED BY <a href="https://github.com/crymis">CRYMIS</a> <br /><br /> IMAGES FROM <a
                href="http://giphy.com/" target="_blank" id="giphyapi">GIPHY<span></p>
    </footer>
    <audio controls autoplay loop id="music">
        <source id="source" src="pushit.mp3" type="audio/mp3">
    </audio>

    <script src="jkit_parallax/jquery-1.9.1.min.js"></script>
    <script src="jkit_parallax/jquery.jkit.custom.1.2.16.min.js"></script>
    <script>
        /* calculate date */
        const start = Math.floor(new Date(2026, 0, 10).getTime() / 1000 / 60 / 60 / 24);
        const now = Math.floor(Date.now() / 1000 / 60 / 60 / 24);
        const days = now - start;
        const OFFSET = 20;
        const pushUpsWithOffset = days + OFFSET - 1;

        const giphyJson = `https://api.giphy.com/v1/gifs/search?api_key=63mUfxHHR8fvH1UWcZuamrQZujuhmZDK&q=push+ups&limit=1&offset=${days}&rating=r&lang=en&bundle=messaging_non_clips`;
        let imageUrl = '';
        // fetch giphy json
        const giphyResponse = fetch(giphyJson)
            .then(response => response.json())
            .then(json => {
                imageUrl = json.data[0].images.original.webp;
                document.getElementById("bg").setAttribute("style", "background-image: url(" + imageUrl + ")");
            })
            .catch(error => {
                console.error('Error fetching Giphy API:', error);
            });

        document.title = 100 + " Days Push-Ups";

        document.getElementById("today").innerHTML = new Date().toLocaleDateString('de-DE', {
            weekday: undefined,
            year: 'numeric',
            month: '2-digit',
            day: '2-digit'
        }) + " - DAY " + days;
        document.getElementById("pushups").innerHTML = pushUpsWithOffset;
        document.getElementById("subtitle").innerHTML = "PUSH-UPS TODAY";
        // 20 + 21 + 22
        document.getElementById("quote").innerHTML = (((days - 1) * days) / 2) + (days * OFFSET) + " PUSH-UPS DONE IN TOTAL";

        document.getElementById("giphyapi").addEventListener('click', function () {
            document.getElementById("bg").setAttribute("style", "background-image: url(api_giphy_header.gif)");
        });

        document.getElementById("pushup-check").addEventListener('change', function () {
            if (this.checked) {
                $('#checkbox-container').fadeOut(500, function () {
                    $('#quote').css('display', 'flex').hide().fadeIn(500);
                });
            }
        });

        document.getElementById("mute-button").addEventListener('click', function () {
            var audio = document.getElementById('music');
            if (audio.muted) {
                audio.muted = false;
                this.innerHTML = 'ðŸ”Š';
            } else {
                audio.muted = true;
                this.innerHTML = 'ðŸ”‡';
            }
        });

        const quotes = [
            "WORK HARD",
            "UNLEASH THE BEAST",
            "NEVER GIVE UP",
            "ALMOST THERE",
            "YOU ARE A MACHINE",
            "NOTHING CAN STOP YOU",
            "FEEL THE BURN",
            "PUSH YOUR LIMITS",
            "STAY STRONG",
            "MAKE IT HAPPEN",
            "BELIEVE IN YOURSELF",
            "EARN YOUR VICTORY"
        ];

        $(document).ready(function () {
            $('body').jKit();
            var audio = document.getElementById('music');

            // Add gyroscope-based parallax for mobile devices
            if (window.DeviceOrientationEvent && /Mobi|Android/i.test(navigator.userAgent)) {
                window.addEventListener('deviceorientation', function (event) {
                    // Get orientation angles
                    const beta = event.beta;  // -180 to 180 (front to back tilt)
                    const gamma = event.gamma; // -90 to 90 (left to right tilt)

                    if (beta === null || gamma === null) return;

                    // Normalize values to a range suitable for parallax effect
                    // Limit the tilt range to make it more comfortable
                    const maxTilt = 25; // degrees
                    const normalizedX = Math.max(-1, Math.min(1, gamma / maxTilt));
                    const normalizedY = Math.max(-1, Math.min(1, (beta - 90) / maxTilt)); // offset beta by 90 for portrait holding position

                    // Apply parallax effect with different strengths
                    const strengthMultiplier = 50; // pixels of movement
                    $('.parallax').each(function () {
                        const $elem = $(this);
                        // Use a default strength of 1 if no data attribute
                        const moveX = normalizedX * strengthMultiplier;
                        const moveY = normalizedY * strengthMultiplier;

                        $elem.css({
                            'transform': `translate(${moveX}px, ${moveY}px)`,
                            'transition': 'transform 0.1s ease-out'
                        });
                    });
                }, true);
            }

            // center quote
            if (days === 50) {
                $("#pushups").addClass('winningShadowTwo');
                $("#subtitle").addClass('winningShadowTwo');
                $('#madeIt').html("NICE! YOU ARE HALF THROUGH! KEEP GOING!");
                $('.parallax-container').css('top', '-200px');
            }
            if (days > 94 && days < 101) {
                audio.src = "epic.mp3";
                audio.load();
                audio.play();
            }
            if (days === 95) {
                $('#quote').html(quotes[Math.floor(Math.random() * quotes.length)]);// random quote
            }
            if (days === 96) {
                $('#quote').html(quotes[Math.floor(Math.random() * quotes.length)]);// random quote
            }
            if (days === 97) {
                $('#quote').html(quotes[Math.floor(Math.random() * quotes.length)]);// random quote
            }
            if (days === 98) {
                $('#quote').html(quotes[Math.floor(Math.random() * quotes.length)]);// random quote
            }
            if (days === 99) {
                $('#quote').html(quotes[Math.floor(Math.random() * quotes.length)]);// random quote
            }
            if (days === 100) {
                $("#pushups").addClass('winningShadow');
                $("#subtitle").addClass('winningShadow');
                $('#madeIt').html("GO GET 'EM");
                $('#quote').html("YOU DID 5070 PUSH-UPS IN TOTAL");
                $('.parallax-container').css('top', '300px');
                $('.trophyBg').css('display', 'flex');
                audio.src = "epic.mp3";
                audio.load();
                audio.play();
            }
            if (days > 100) {
                document.getElementById("pushups").innerHTML = 100;
                document.getElementById("subtitle").innerHTML = "PUSH-UPS CHALLENGE";
                $('#quote').html("YOU DID (AT LEAST) 5070 PUSH-UPS IN TOTAL");
                $('#quote-info').html("SINCE 10.10.2016");
                $('.parallax-container').css('top', '-100px');
                audio.src = "epic.mp3";
                audio.load();
                audio.play();
            }
        });
    </script>
</body>

</html>